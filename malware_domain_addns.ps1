$tmp_file_holder = "current_list.bk"

$rollback_path = "C:\scripts\current_roll_back.list"
$rollback_date = get-date -format "M_dd_yyyy"
$rollback_backup_file = $rollback_path + "rollback_" + $rollback_date + ".bat"

move-item $rollback_path $rollback_backup_file -force

$domain_list = invoke-webrequest http://mirror1.malwaredomains.com/files/domains.txt | select -expandproperty content
$domain_list -replace "`t", ";" -replace ";;" >  $tmp_file_holder
$domain_content = get-content $tmp_file_holder

$zone_list = get-dnsserverzone | where {$_.IsDsIntegrated -eq $false} | select -expandproperty Zonename

foreach($line in $domain_content){
	if(-not($line | select-string "##")) {
	$line_tmp = $line -split ";"
	$line = $line_tmp[0]
		if($zone_list -notcontains $line) {
		Add-DnsServerPrimaryZone "$line" -DynamicUpdate "none" -ZoneFile "$line.dns"
		echo "$line" | Out-File -FilePath $rollback_file -Encoding ascii -append
		sleep 1
		}
	}
}